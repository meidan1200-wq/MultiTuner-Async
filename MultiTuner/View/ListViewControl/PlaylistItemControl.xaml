<local:BaseListControl
    x:Class="MultiTuner.View.ListViewControl.PlaylistItemControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:MultiTuner.View.ListViewControl"
    xmlns:dd="clr-namespace:GongSolutions.Wpf.DragDrop;assembly=GongSolutions.Wpf.DragDrop"
    mc:Ignorable="d"
    d:DesignHeight="450" d:DesignWidth="800">
    <Grid>
        <ListBox Name="PlaylistList"
                 ItemsSource="{Binding Items, RelativeSource={RelativeSource AncestorType=local:BaseListControl}}"
                 SelectedItem="{Binding SelectedItem, RelativeSource={RelativeSource AncestorType=local:PlaylistItemControl}, Mode=TwoWay}"
                 SelectionMode="Single"
                 PreviewMouseDown="PlaylistList_PreviewMouseDown"
                 BorderThickness="0"
                 Background="Transparent"
                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                 dd:DragDrop.IsDragSource="True"
                 dd:DragDrop.IsDropTarget="True"
                 dd:DragDrop.UseDefaultDragAdorner="True"
                 dd:DragDrop.DropTargetAdornerBrush="LimeGreen">
            <!-- WrapPanel layout -->
            <ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                    <WrapPanel />
                </ItemsPanelTemplate>
            </ListBox.ItemsPanel>
            <!-- Selection visuals -->
            <ListBox.ItemContainerStyle>
                <Style TargetType="ListBoxItem">
                    <Setter Property="Padding" Value="0" />
                    <Setter Property="Margin" Value="5" />
                    <Setter Property="Background" Value="Transparent" />
                    <Setter Property="BorderThickness" Value="0" />
                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="#2D2D30" />
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </ListBox.ItemContainerStyle>
            <!-- Item template -->
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <Border x:Name="ItemContainer" CornerRadius="10" Padding="8" Width="120" Background="Transparent">
                        <Border.LayoutTransform>
                            <ScaleTransform
                    ScaleX="{Binding Scale, RelativeSource={RelativeSource AncestorType=local:BaseListControl}}"
                    ScaleY="{Binding Scale, RelativeSource={RelativeSource AncestorType=local:BaseListControl}}" />
                        </Border.LayoutTransform>

                        <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                            <Image Source="{Binding ThumbnailUrl}" Width="80" Height="80" Stretch="Fill" Margin="0,0,0,5">
                                <Image.Clip>
                                    <RectangleGeometry Rect="0,0,80,80" RadiusX="7" RadiusY="7" />
                                </Image.Clip>
                            </Image>

                            <Grid x:Name="TextContainer" ClipToBounds="True" HorizontalAlignment="Stretch">
                                <TextBlock x:Name="TitleText"
                               Text="{Binding Title}"
                               Foreground="Silver"
                               FontSize="14"
                               FontFamily="Segoe UI Semibold"
                               FontWeight="SemiBold"
                               HorizontalAlignment="Left"
                               TextTrimming="CharacterEllipsis"
                               TextWrapping="NoWrap">
                                    <TextBlock.RenderTransform>
                                        <TranslateTransform x:Name="TextTransform" X="0" />
                                    </TextBlock.RenderTransform>
                                </TextBlock>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <DataTemplate.Triggers>
                        <Trigger Property="IsMouseOver" Value="True" SourceName="ItemContainer">
                            <Setter TargetName="TitleText" Property="TextTrimming" Value="None" />

                            <Trigger.EnterActions>
                                <BeginStoryboard x:Name="ScrollAnimation">
                                    <Storyboard>
                                        <DoubleAnimation
                                Storyboard.TargetName="TextTransform"
                                Storyboard.TargetProperty="X"
                                From="0"
                                To="-50" 
                                Duration="0:0:3"
                                RepeatBehavior="Forever"
                                AutoReverse="True"
                                BeginTime="0:0:0.5" />
                                    </Storyboard>
                                </BeginStoryboard>
                            </Trigger.EnterActions>

                            <Trigger.ExitActions>
                                <StopStoryboard BeginStoryboardName="ScrollAnimation" />
                            </Trigger.ExitActions>
                        </Trigger>
                    </DataTemplate.Triggers>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid>
</local:BaseListControl>